<Window x:Class="P5S3.EditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:xlinq="clr-namespace:System.Xml.Linq;assembly=System.Xml.Linq"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:c="clr-namespace:P5S3"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="XML редактор" Height="500" Width="700" Background="#bfe6ff" ResizeMode="NoResize">
    <Window.Resources>
        <!--стили-->
        <Style x:Key="ButtonStyle1" TargetType="Button">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#FFA9AECA"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontFamily" Value="Arial"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                        Background="{TemplateBinding Background}"
                        RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <ScaleTransform x:Name="scaleTransform" ScaleX="1" ScaleY="1"/>
                            </Border.RenderTransform>
                            <ContentPresenter HorizontalAlignment="Center" 
                                    VerticalAlignment="Center"
                                    Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Нормальное состояние -->
                            <Trigger Property="IsMouseOver" Value="False">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <ImageBrush ImageSource="/button.png" 
                                            Stretch="Fill"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>

                            <!-- Наведение мыши -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <ImageBrush ImageSource="/button(preessed).png" 
                                            Stretch="Fill"/>
                                    </Setter.Value>
                                </Setter>
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                                   Storyboard.TargetProperty="ScaleY"
                                                   To="1.05" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                                   Storyboard.TargetProperty="ScaleX"
                                                   To="1" Duration="0:0:0.2"/>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                                   Storyboard.TargetProperty="ScaleY"
                                                   To="1" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ButtonStyle2" TargetType="Button">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#FFA9AECA"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontFamily" Value="Arial"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                Background="{TemplateBinding Background}"
                RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <ScaleTransform x:Name="scaleTransform" ScaleX="1" ScaleY="1"/>
                            </Border.RenderTransform>
                            <ContentPresenter HorizontalAlignment="Center" 
                            VerticalAlignment="Center"
                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Нормальное состояние -->
                            <Trigger Property="IsMouseOver" Value="False">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <ImageBrush ImageSource="/button.png" 
                                    Stretch="Fill"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>

                            <!-- Наведение мыши -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <ImageBrush ImageSource="/button(preessed).png" 
                                    Stretch="Fill"/>
                                    </Setter.Value>
                                </Setter>
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                            Storyboard.TargetProperty="ScaleX"
                                            To="1.05" Duration="0:0:0.2"/>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                            Storyboard.TargetProperty="ScaleY"
                                            To="1.05" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                           Storyboard.TargetProperty="ScaleX"
                                           To="1" Duration="0:0:0.2"/>
                                            <DoubleAnimation Storyboard.TargetName="scaleTransform"
                                           Storyboard.TargetProperty="ScaleY"
                                           To="1" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="CustomScrollBar" TargetType="ScrollBar">
            <Setter Property="Width" Value="15"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid>
                            <Border Background="#80b2d1"/>
                            <Track x:Name="PART_Track">
                                <Track.Thumb>
                                    <Thumb Background="#062233">
                                        <Thumb.BorderBrush>#000</Thumb.BorderBrush>
                                        <Thumb.BorderThickness>2</Thumb.BorderThickness>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--ресурсы изображения-->
        <ImageBrush x:Key="VerticalSplitterTexture" 
                ImageSource="/Wall.png" 
                Stretch="Fill" />
        <ImageBrush x:Key="HorizontalSplitterTexture" 
                ImageSource="/Wall.png"
                Stretch="Fill">
            <ImageBrush.RelativeTransform>
                <RotateTransform Angle="90" CenterX="0.5" CenterY="0.5"/>
            </ImageBrush.RelativeTransform>
        </ImageBrush>
    </Window.Resources>
    <Grid>
        <!-- рамки -->
        <Grid.RowDefinitions>
            <RowDefinition Height="5"/>
            <RowDefinition Height="5"/>
            <RowDefinition/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="5"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition  Width="5"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition/>
            <ColumnDefinition  Width="5"/>
            <ColumnDefinition Width="5"/>
        </Grid.ColumnDefinitions>
        <Rectangle Grid.Column="1" Grid.RowSpan="5" Fill="#000"/>
        <Rectangle Grid.Column="3" Grid.RowSpan="5" Fill="#000"/>
        <Rectangle Grid.Row="1" Grid.ColumnSpan="5" Fill="#000"/>
        <Rectangle Grid.Row="3" Grid.ColumnSpan="5" Fill="#000"/>
        <Rectangle Grid.Row="0" Grid.ColumnSpan="5" Fill="#062233"/>
        <Rectangle Grid.Row="4" Grid.ColumnSpan="5" Fill="#062233"/>
        <Rectangle Grid.Column="0" Grid.RowSpan="5" Fill="#062233"/>
        <Rectangle Grid.Column="4" Grid.RowSpan="5" Fill="#062233"/>

        <DockPanel Grid.Row="2" Grid.Column="2">
            <!-- Левая панель -->
            
            <Grid DockPanel.Dock="Left" Width="360" Background="#bfe6ff" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="58"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <!-- загоголовк - путь к файлу -->
                <Border Grid.Row="0"
                        Margin="1"
                        RenderTransformOrigin="0.5,0.5" BorderThickness="0" BorderBrush="Transparent" Padding="5">
                    <Border.Background>
                        <ImageBrush ImageSource="/button(preessed).png"  Stretch="Fill"/>
                    </Border.Background>
                    <TextBlock x:Name="FilePathTextBlock"
                               Text="{Binding Path=FilePath, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               TextWrapping="Wrap"
                               FontSize="18"
                               Foreground="#FFA9AECA"
                               FontWeight="Bold"
                               FontFamily="Arial"
                               Margin="2"
                               TextAlignment="Center"/>
                </Border>
                <Button Click="FindFor" Content="Начать поиск" Style ="{StaticResource ButtonStyle1}" Grid.Row="1"  Margin="1"/>
                <Button Click="Change" Content="Изменить" Style ="{StaticResource ButtonStyle1}" Grid.Row="2" Margin="1"/>
                <Button Click="Delete" Content="Удалить" Style ="{StaticResource ButtonStyle1}" Grid.Row="3"  Margin="1"/>
                <Button Click="AddData" Content="Добавить" Style ="{StaticResource ButtonStyle1}" Grid.Row="4"  Margin="1"/>
                <Button Click="Save" Content="Сохранить файл" Style ="{StaticResource ButtonStyle1}" Grid.Row="5"  Margin="1"/>
                <Button Click="Back" Content="Выбрать файл" Style ="{StaticResource ButtonStyle1}" Grid.Row="6"  Margin="1"/>
            </Grid>
            <!-- кастомная стенка -->
            <GridSplitter DockPanel.Dock="Left" 
                  Width="10"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Stretch"
                  Background="{StaticResource VerticalSplitterTexture}" RenderTransformOrigin="0.5,0.5">
                <GridSplitter.Template>
                    <ControlTemplate>
                        <Border Background="{TemplateBinding Background}"/>
                    </ControlTemplate>
                </GridSplitter.Template>
            </GridSplitter>
            <!-- вывод XML в строку -->
            <TextBox DockPanel.Dock="Top" Height="150" Background="#bfe6ff" 
                     Name="tbRawXml" Text="{Binding Path=DateXml, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}" 
                     FontSize="14"
                     Foreground="#FF2D2D2D"
                     FontWeight="Bold"
                     FontFamily="Arial"
                     VerticalScrollBarVisibility="Auto"
                     HorizontalScrollBarVisibility="Auto"
                     TextWrapping="Wrap"
                     IsReadOnly="True" Cursor="No">
                <TextBox.Resources>
                    <Style TargetType="ScrollBar" BasedOn="{StaticResource CustomScrollBar}"/>
                </TextBox.Resources>
            </TextBox>
            <!-- кастомная стенка -->
            <GridSplitter DockPanel.Dock="Top" 
              Height="10"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Center"
              Background="{StaticResource HorizontalSplitterTexture}" RenderTransformOrigin="0.5,0.5">
                <GridSplitter.Template>
                    <ControlTemplate>
                        <Border Background="{TemplateBinding Background}"/>
                    </ControlTemplate>
                </GridSplitter.Template>
            </GridSplitter>
            
            
            <Grid DockPanel.Dock="Right" Width="Auto">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Border x:Name="SearrchBorder" Grid.Row="0"  BorderBrush="Black" 
                        BorderThickness="1" Padding="0">
                    <Grid x:Name="SearchGrid" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                            
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6" Margin="1">
                            <TextBlock Text="Поиск дат" 
                                        TextWrapping="Wrap"
                                        FontSize="12"
                                        Foreground="#FFA9AECA" 
                                        FontWeight="Bold"
                                        FontFamily="Arial" 
                                        HorizontalAlignment="Center" VerticalAlignment="Center">
                            </TextBlock>
                            <Border.Background>
                                <ImageBrush ImageSource="/button.png" Stretch="Fill"/>
                            </Border.Background>
                        </Border>
                        <Button Grid.Row="0" Grid.Column="6" Grid.ColumnSpan="2" Margin="1"
                                    Content="Скрыть" Click="CloseFindWindow_Click"
                                    Style ="{StaticResource ButtonStyle2}" 
                                    />

                        <Border Grid.Row="1" Grid.ColumnSpan="8" Margin="1">
                            <StackPanel Orientation="Horizontal">
                        <TextBlock Text=" ID:" Margin="5" VerticalAlignment="Center"
                                   FontFamily="Arial" Foreground="#FFA9AECA"/>
                        <TextBox x:Name="IdTextBox1" Grid.Row="1" 
                                    Margin="5" Width="20"
                                    Text="{Binding Path=Id, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
                                
                        <TextBlock Text="День:"  Margin="5" VerticalAlignment="Center"
                                   FontFamily="Arial" Foreground="#FFA9AECA"/>
                        <TextBox x:Name="DayTextBox1" Grid.Row="1" Width="30"
                                    Margin="5" 
                                    Text="{Binding Path=Day, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
                        <TextBlock Text="Месяц:"  Margin="5" VerticalAlignment="Center"
                                   FontFamily="Arial" Foreground="#FFA9AECA"/>
                        <TextBox x:Name="MonthTextBox1" Grid.Row="1" 
                                    Margin="5" Width="20"
                                    Text="{Binding Path=Month, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
                        <TextBlock Text="Год:" Grid.Row="1" Grid.Column="6" Margin="5" VerticalAlignment="Center"
                                   FontFamily="Arial" Foreground="#FFA9AECA"/>
                        <TextBox x:Name="YearTextBox1"  
                                    Margin="5" Width="30"
                                    Text="{Binding Path=Year, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
                            </StackPanel>
                            <Border.Background>
                                <ImageBrush ImageSource="/button.png" Stretch="Fill"/>
                            </Border.Background>
                        </Border>

                    </Grid>
                </Border>
                <!-- список дат -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden">
                    <ListView x:Name="mylist" Background="#bfe6ff" BorderThickness="0"  Margin="0,2,0,0" >
                        <ListView.Resources>
                            <!-- Для названий столбцов -->
                            <Style TargetType="GridViewColumnHeader">
                                <Setter Property="Background" Value="#062233"/>
                                <Setter Property="Foreground" Value="#FFA9AECA"/>
                                <Setter Property="FontFamily" Value="Arial"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                                <Setter Property="IsHitTestVisible" Value="False"/>
                            </Style>
                        </ListView.Resources>
                        <ListView.ItemContainerStyle>
                            <!-- Для строк -->
                            <Style TargetType="ListViewItem">
                                <Setter Property="Height" Value="15"/>
                                <Setter Property="FontSize" Value="12"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="Foreground" Value="Black"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderBrush" Value="Black"/>
                                <Setter Property="BorderThickness" Value="2,1"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="2,0,2,0"/>
                                    
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListViewItem">
                                            <Border x:Name="Bd"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    Padding="{TemplateBinding Padding}">
                                                <GridViewRowPresenter />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <!-- При выделении -->
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="Bd" Property="Background" Value="#062233"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </Trigger>
                                                <!-- При наведении -->
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Bd" Property="Background" Value="#80b2d1"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Сортировка">
                                    <MenuItem Header="По возрастанию" Click="SortAscending_Click"/>
                                    <MenuItem Header="По убыванию" Click="SortDescending_Click"/>
                                </MenuItem>
                            </ContextMenu>
                        </ListView.ContextMenu>
                        <ListView.View>
                            <GridView>
                                <GridViewColumn  Header=" ID:" DisplayMemberBinding="{Binding Attribute[id].Value}" Width="25">
                                </GridViewColumn>
                                                
                                <GridViewColumn Header="День" DisplayMemberBinding="{Binding Attribute[day].Value}" Width="45"/>
                                <GridViewColumn Header="Месяц" DisplayMemberBinding="{Binding Attribute[month].Value}" Width="60"/>
                                <GridViewColumn Header="Год / Пкм.для сортировки" DisplayMemberBinding="{Binding Attribute[year].Value}" Width="159"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <ScrollViewer.Resources>
                        <Style TargetType="ScrollBar" BasedOn="{StaticResource CustomScrollBar}"/>
                    </ScrollViewer.Resources>
                </ScrollViewer>
                <!-- Панель добавления данных -->
                <Border x:Name="InputBorder" Grid.Row="2"  BorderBrush="Black" BorderThickness="0,5,0,0" Padding="0">
                    <Grid x:Name="InputGrid" Visibility="Collapsed">
                        <Grid.RowDefinitions> 
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="Добавление/Изменение даты" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" 
                    FontWeight="Bold" FontSize="12" Margin="0,0,0,10" HorizontalAlignment="Center"/>

                        <TextBlock Text="ID:" Grid.Row="1" Grid.Column="0" Margin="5" VerticalAlignment="Center"/>
                        <TextBox x:Name="IdTextBox" Grid.Row="1" Grid.Column="1" Margin="5" Text="1"/> 
                            
                        <TextBlock Text="День:" Grid.Row="2" Grid.Column="0" Margin="5" VerticalAlignment="Center"/>
                        <TextBox x:Name="DayTextBox" Grid.Row="2" Grid.Column="1" Margin="5" Text="1"/>

                        <TextBlock Text="Месяц:" Grid.Row="3" Grid.Column="0" Margin="5" VerticalAlignment="Center"/>
                        <TextBox x:Name="MonthTextBox" Grid.Row="3" Grid.Column="1" Margin="5" Text="1"/>

                        <TextBlock Text="Год:" Grid.Row="4" Grid.Column="0" Margin="5" VerticalAlignment="Center"/>
                        <TextBox x:Name="YearTextBox" Grid.Row="4" Grid.Column="1" Margin="5" Text="2024"/>
                            
                        <TextBlock x:Name="ErrorTextBlock" Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" 
                    Foreground="Red" TextWrapping="Wrap" TextAlignment="Center"/>

                        <StackPanel Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" 
                    HorizontalAlignment="Center" Margin="0,10,0,0">
                            <Button Content="Добавить" Click="ConfirmAddButton_Click" Style ="{StaticResource ButtonStyle2}" Margin="5" Width="80"/>
                            <Button Content="Отмена" Click="CancelAddButton_Click" Style ="{StaticResource ButtonStyle2}" Margin="5" Width="80"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </DockPanel>



    </Grid>
</Window>
